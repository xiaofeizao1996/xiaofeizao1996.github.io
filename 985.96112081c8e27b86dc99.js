"use strict";(self.webpackChunkmain=self.webpackChunkmain||[]).push([[985],{61138:(e,t,r)=>{r.d(t,{Lx:()=>o,i5:()=>i});var n=r(22155);const a={theme:"vs-dark",automaticLayout:!0,minimap:{enabled:!1},scrollBeyondLastLine:!1,fontSize:14,lineNumbers:"on",wordWrap:"on",readOnly:!1},s=()=>{const e=(0,n.useRef)(null),t=(0,n.useRef)(null),s=(0,n.useRef)(!1),i=async()=>await Promise.all([r.e(440),r.e(96),r.e(715)]).then(r.bind(r,84153)),o=()=>{e.current&&("function"==typeof e.current.dispose&&e.current.dispose(),e.current=null,s.current=!1)};return(0,n.useEffect)(()=>o,[]),{editorRef:e,containerRef:t,isInitializedRef:s,loadMonaco:i,initMonacoEditor:async(r,n={},o=!1)=>{if(t.current&&(!s.current||o))try{const l=await i();requestAnimationFrame(async()=>{if(t.current&&(!e.current||o)){const i={...a,...n},o=r(l,t.current,i);e.current=o instanceof Promise?await o:o,s.current=!0}})}catch(e){console.error("Failed to initialize Monaco editor:",e)}},disposeEditor:o,DEFAULT_CONFIG:a}},i=e=>{const{value:t,onChange:r,language:a="plaintext",theme:i,readOnly:o,automaticLayout:l}=e,{editorRef:c,containerRef:d,isInitializedRef:x,initMonacoEditor:u}=s();return(0,n.useEffect)(()=>{u((e,n,s)=>{const i=e.editor.create(n,{value:t,language:a,...s});return i.onDidChangeModelContent(()=>{const e=i?.getValue()||"";r(e)}),i},{theme:i,readOnly:o,automaticLayout:l})},[a,r]),(0,n.useEffect)(()=>{if(c.current&&x.current){const e=c.current;e.getValue()!==t&&e.setValue(t)}},[t]),{containerRef:d,focusEditor:()=>{const e=c.current;e?.focus()},editor:c.current}},o=e=>{const{leftText:t,rightText:r,viewMode:a,theme:i}=e,{editorRef:o,containerRef:l,isInitializedRef:c,initMonacoEditor:d,loadMonaco:x}=s();return(0,n.useEffect)(()=>{d((e,n,s)=>{const i=e.editor.createDiffEditor(n,{...s,renderSideBySide:"split"===a,enableSplitViewResizing:!0,renderLineHighlight:"all",readOnly:!0}),o=e.editor.createModel(t,"plaintext"),l=e.editor.createModel(r,"plaintext");return i.setModel({original:o,modified:l}),i},{theme:i})},[]),(0,n.useEffect)(()=>{c.current&&(async()=>{if(o.current&&c.current)try{const e=await x(),n=e.editor.createModel(t,"plaintext"),a=e.editor.createModel(r,"plaintext");o.current.setModel({original:n,modified:a})}catch(e){console.error("Failed to update diff model:",e)}})()},[t,r]),{containerRef:l,editor:o.current}}},86680:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(65723),a=r(22155),s=r(61138);const i=a.memo(({value:e,onChange:t,language:r="plaintext",theme:a="vs-dark",readOnly:i=!1,className:o=""})=>{const{containerRef:l,focusEditor:c}=(0,s.i5)({value:e,onChange:t,language:r,theme:a,readOnly:i});return(0,n.jsx)("div",{className:`relative w-full h-full cursor-text ${o}`,ref:l,onClick:c})})},86985:(e,t,r)=>{r.r(t),r.d(t,{default:()=>m});var n=r(65723),a=r(22155),s=r(86680),i=r(61138);const o=a.memo(({leftText:e,rightText:t,viewMode:r})=>{const{containerRef:a}=(0,i.Lx)({leftText:e,rightText:t,viewMode:r});return(0,n.jsx)("div",{className:"w-full h-full",ref:a})});var l=r(9967);const c=a.memo(({hasContent:e,onCompare:t,onClear:r})=>(0,n.jsxs)("div",{className:"flex space-x-2",children:[(0,n.jsx)("button",{onClick:t,disabled:!e,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-sm transition-colors",children:"对比差异"}),(0,n.jsx)("button",{onClick:r,className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 text-sm transition-colors",children:"清空"})]})),d=a.memo(({viewMode:e,onBackToEdit:t,onClear:r,onViewModeChange:a})=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2 bg-gray-100 rounded-md p-1",children:[(0,n.jsx)("button",{onClick:()=>a("split"),className:"px-3 py-1 text-sm rounded transition-colors "+("split"===e?"bg-white shadow-sm":"hover:bg-gray-200"),children:"分屏对比"}),(0,n.jsx)("button",{onClick:()=>a("unified"),className:"px-3 py-1 text-sm rounded transition-colors "+("unified"===e?"bg-white shadow-sm":"hover:bg-gray-200"),children:"统一视图"})]}),(0,n.jsxs)("div",{className:"flex space-x-2",children:[(0,n.jsx)("button",{onClick:t,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 text-sm transition-colors",children:"返回修改"}),(0,n.jsx)("button",{onClick:r,className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 text-sm transition-colors",children:"清空"})]})]})),x=a.memo(({showDiff:e,viewMode:t,hasContent:r,onCompare:a,onBackToEdit:s,onClear:i,onViewModeChange:o})=>{const x=(0,l.Zp)();return(0,n.jsxs)("div",{className:"bg-white border-b border-gray-200 px-4 py-2 flex items-center justify-between flex-shrink-0 z-10",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,n.jsxs)("button",{onClick:()=>x("/tools"),className:"px-3 py-1.5 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded transition-colors flex items-center space-x-1",title:"返回工具列表",children:[(0,n.jsx)("span",{children:"←"}),(0,n.jsx)("span",{children:"返回"})]}),(0,n.jsx)("div",{className:"border-l border-gray-300 h-8"}),(0,n.jsx)("h1",{className:"text-lg font-semibold text-gray-900",children:"文件差异对比"})]}),(0,n.jsx)("div",{className:"flex items-center space-x-4",children:e?(0,n.jsx)(d,{viewMode:t,onBackToEdit:s,onClear:i,onViewModeChange:o}):(0,n.jsx)(c,{hasContent:r,onCompare:a,onClear:i})})]})}),u=a.memo(()=>{const[e,t]=(0,a.useState)(""),[r,i]=(0,a.useState)(""),[l,c]=(0,a.useState)(!1),[d,u]=(0,a.useState)("split"),[m,f]=(0,a.useState)(0),h=(0,a.useCallback)(()=>{(e.trim()||r.trim())&&c(!0)},[e,r]),g=(0,a.useCallback)(()=>{c(!1)},[]),p=(0,a.useCallback)(()=>{t(""),i(""),c(!1)},[]),y=(0,a.useCallback)(e=>{u(e),requestAnimationFrame(()=>{f(e=>e+1)})},[]),b=(0,a.useMemo)(()=>!(!e.trim()&&!r.trim()),[e,r]);return(0,n.jsxs)("div",{className:"fixed inset-0 flex flex-col bg-gray-50",children:[(0,n.jsx)(x,{showDiff:l,viewMode:d,hasContent:b,onCompare:h,onBackToEdit:g,onClear:p,onViewModeChange:y}),l?(0,n.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,n.jsxs)("div",{className:"flex flex-shrink-0",children:[(0,n.jsx)("div",{className:"flex-1 bg-gray-800 px-4 py-2 text-gray-300 text-sm font-medium border-r border-gray-600",children:"原始文件"}),(0,n.jsx)("div",{className:"flex-1 bg-gray-800 px-4 py-2 text-gray-300 text-sm font-medium",children:"修改文件"})]}),(0,n.jsx)("div",{className:"flex-1",children:(0,n.jsx)(o,{leftText:e,rightText:r,viewMode:d},m)})]}):(0,n.jsxs)("div",{className:"flex-1 flex",children:[(0,n.jsxs)("div",{className:"flex-1 flex flex-col border-r border-gray-300",children:[(0,n.jsx)("div",{className:"bg-gray-800 px-4 py-2 text-gray-300 text-sm font-medium flex-shrink-0",children:"原始文件"}),(0,n.jsx)("div",{className:"flex-1",children:(0,n.jsx)(s.A,{value:e,onChange:t})})]}),(0,n.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,n.jsx)("div",{className:"bg-gray-800 px-4 py-2 text-gray-300 text-sm font-medium flex-shrink-0",children:"修改文件"}),(0,n.jsx)("div",{className:"flex-1",children:(0,n.jsx)(s.A,{value:r,onChange:i})})]})]})]})}),m=()=>(0,n.jsx)(u,{})}}]);
//# sourceMappingURL=985.96112081c8e27b86dc99.js.map